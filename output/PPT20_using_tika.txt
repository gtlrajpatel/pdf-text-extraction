











































OOPC++ UNIT-1


Prof. Rupesh G. Vaishnav
rupesh.vaishnav@darshan.ac.in
94280-37452
Information & Network Security (2170709)	 Darshan Institute of Engineering & Technology
UNIT-8
Key management and distribution 





1

Outline
Key management and distribution
Symmetric key distribution using symmetric  encryption
Symmetric key distribution asymmetric encryption
Distribution of public keys
X.509 certificates
Public key infrastructure (PKI)

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

X.800 and RFC 2828
International Telecommunication Union (ITU)
2

Key Distribution
Key distribution is the function that delivers a key to two parties who wish to exchange secure encrypted data. 
Some sort of mechanism or protocol is needed to provide for the secure distribution of keys.
Key distribution often involves the use of master keys, which are infrequently used and are long lasting, and session keys, which are generated and distributed for temporary use between two parties.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Key Hierarchy 
Communication between end systems is encrypted using a temporary key, often referred to as a session key.
Session keys are transmitted in encrypted form, using a master key that is shared by the key distribution center and an end system or user


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Simple Secret Key Distribution
A generates a public/private key pair {PUa, PRa} and transmits a message to B consisting of PUa and an identifier of A, IDA.  
B generates a secret key, Ks, and transmits it to A, encrypted with A's public key.  
A computes D(PRa, E(PUa, Ks)) to recover the secret key. Because only A can decrypt the message, only A and B will know the identity of Ks.  
A discards PUa and PRa and B discards PUa. 
Initiator
A
Initiator
B
(2) E(PUa , Ks)
(1) PUa || IDA


Secret Key Distribution with Confidentiality & Authentication
A uses B's public key to encrypt a message to B containing an identifier of A (IA) and a nonce (N1), which is used to identify this transaction uniquely.  
B sends a message to A encrypted with PUa and containing A's (N1) as well as a new nonce generated by B (N2). Because only B could have decrypted message (1), the presence of N1 in message (2) assures A that the correspondent is B.  
Initiator
A
Initiator
B
(1) E(PUb,[N1||IDA])
(2) E(PUa,[N1|| N2])
(3) E(PUb,N2])
(4) E(Pub,E(PRa,Ks))


Secret Key Distribution with Confidentiality & Authentication
A returns N2, encrypted using B's public key, to assure B that its correspondent is A.  
A selects a secret key Ks and sends M = E(PUb, E(PRa, Ks)) to B. Encryption with B's public key ensures that only B can read it; encryption with A's private key ensures that only A could have sent it.  
B computes D(PUa, D(PRb, M)) to recover the secret key.   
Initiator
A
Initiator
B
(1) E(PUb,[N1||IDA])
(2) E(PUa,[N1|| N2])
(3) E(PUb,N2])
(4) E(Pub,E(PRa,Ks))


Symmetric key distribution using symmetric encryption
Two parties A and B, key distribution can be achieved in a number of ways, as follows:
A can select a key and physically deliver key to B.
Third party can select the key and physically deliver it to A and B.
If A and B have previously and recently used a key, one party can transmit the new key to the other, encrypted using the old key.
If A and B each has an encrypted connection to a third party C, C can deliver a key on the encrypted links to A and B.



Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Key Distribution Scenario
Key Distribution Center (Key)
Initiator
A
Initiator
B
(1) IDA || IDB || N1
(2) E(Ka, [Ks || IDA || IDB || N1]) || E(Kb, [Ks || IDA]) 
(3) E(Kb, [Ks || IDA])
(4) E(Ks, N2])
(5) E(Ks, f(N2))

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Key Distribution Scenario
A requests from the KDC a session key to protect a logical connection to B. The message includes the identity of A and B and a unique nonce N1. 
The KDC responds with a message encrypted using Ka that includes a one-time session key Ks to be used for the session, the original request message to enable A to match response with appropriate request, and info for B
A stores the session key for use in the upcoming session and forwards to B the information from the KDC for B, namely, E(Kb, [Ks || IDA]). 
At this point, a session key has been securely delivered to A and B, and they may begin their protected exchange. 
Using the new session key for encryption B sends a nonce N2 to A.  
Also using Ks, A responds with f(N2). These steps assure B that the original message it received (step 3) was not a replay. Note that the actual key distribution involves only steps 1 through 3 but that steps 4 and 5, as well as 3, perform an authentication function.


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Distribution of Public Keys
Public announcement
Publicly available directory
Public-key authority
Public-key certificates

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

1. Public Announcement
Some user could pretend to be user A and send a public key to another participant or broadcast such a public key. 
Until such time as user A discovers the forgery and alerts other participants, the forger is able to read all encrypted messages intended for A and can use the forged keys for authentication


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

2. Publicly Available Directory
The authority maintains a directory with a {name, public key} entry for each participant.
Each participant registers a public key with the directory authority. 
A participant may replace the existing key with a new one at any time.
Participants could also access the directory electronically. For this purpose, secure, authenticated communication from the authority to the participant is mandatory.


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

3. Public-Key Authority
Initiator
A
Initiator
B
(6) E(PUa , [N1 || N2])
Public-Key Authority
(1) Request || T1
(2) E(PRauth, [PUb || Request || T1])
(4) Request || T2
(5) E(PRauth, [PUa || Request || T2])
(3) E (PUb, [IDa, N1])
(7) E(PUb, N2)


3. Public-Key Authority – Cont…
A sends a timestamped message to the public-key authority containing a request for the current public key of B.
The authority responds with a message that is encrypted using the authority’s private key .
Message contains PUb, Original request, Original time stamp T1
A stores B’s public key and also uses it to encrypt a message to B containing an identifier of A(IDa) and a nonce(N1) , which is used to identify this transaction uniquely.
4, 5. B retrieves A’s public key from the authority in the same manner as A retrieved B’s public key.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

3. Public-Key Authority – Cont…
B sends a message to A encrypted with PUa and containing A’s nonce(N1) as well as a new nonce generated by B(N2). Because only B could have decrypted message (3), the presence of N1 in message (6) assures A that the correspondent is B.
A returns N2, which is encrypted using B’s public key, to assure B that its correspondent is A.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

4. Public-Key Certificates 
Any participant can read a certificate to determine the name and public key of the certificate’s owner.
Any participant can verify that the certificate originated from the certificate authority and is not counterfeit.
Only the certificate authority can create and update certificates.
Any participant can verify the currency of the certificate.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

4. Public-Key Certificates – Cont… 
Initiator
A
Initiator
B
(2) CA
(1) CA
Certificate
Authority
PUa
CA = E(PRauth, [T1 || IDa || PUa])
PUb
CA = E(PRauth, [T2 || IDb || PUb])


4. Public-Key Certificates – Cont… 
Each participant applies to the certificate authority, supplying a public key and requesting a certificate.
For participant A, the authority provides a certificate of the form
CA = E (PRauth, [T || IDa || PUa] )
A may then pass this certificate on to any other participant, who reads and verifies the certificate as follows:
                           D(PUauth, CA) 
= D(PUauth, E (PRauth, [T || IDa || PUa] )) 
                        = (T || IDa || PUa)


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

X.509 Certificates
X.509 defines the format for public-key certificates. used in a variety of applications.
X.509 defines a framework for the provision of authentication services by the X.500 directory to its users. 
The directory may serve as a repository of public-key certificates.
Each certificate contains the public key of a user and is signed with the private key of a trusted certification authority. 

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

X.509 Formats
Version
Certificate
serial number
Algorithm
Parameters
Issuer name
Not before
Not after
Subject name
Algorithms
Parameters
Key
Issuer Unique identifier
Extensions
Algorithms
Parameters
Encrypted hash

Signature 
algorithm
identifier 

Proof of validity

Subject’s public key info

Signature
Subject Unique identifier
Version 1
Version 2
Version 3
All
Versions


X.509 Format – Cont…
Version: Differentiates among successive versions of the certificate format; the default is version 1. 
Serial number: An integer value unique within the issuing CA that is unambiguously associated with this certificate.
Signature algorithm identifier: The algorithm used to sign the certificate  together with any associated parameters. 
Issuer name: X.500 name of the CA that created and signed this certificate.
Period of validity: Consists of two dates: the first and last on which the certificate is valid.
Subject name: The name of the user to whom this certificate refers. 


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

X.509 Format – Cont…
Subject’s public-key information: The public key of the subject, plus an identifier of the algorithm for which this key is to be used, together with any associated parameters.
Issuer unique identifier: An optional-bit string field used to identify uniquely the issuing CA in the event the X.500 name has been reused for different entities.
Subject unique identifier: An optional-bit string field used to identify uniquely the subject in the event the X.500 name has been reused for different entities.
Extensions: A set of one or more extension fields.


Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Public-Key Certificate Use

H
E

D

CA
information
Bob’s Public key
Bob’s ID information

H


Generate hash
code of unsigned
certificate

Encrypt hash code
with CA's private key
to form signature

Decrypt signature
with CA's public key
to recover hash code
Recipient can verify
signature by comparing
hash code values
Signed Certificate
Unsigned certificate:
contains user ID,
user's public key

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Public key Infrastructure (PKI)
A public-key infrastructure (PKI) is defined as the set of hardware, software, people, policies, and procedures needed to create, manage, store, distribute, and revoke digital certificates based on asymmetric cryptography.
The principal objective for developing a PKI is to enable secure, convenient, and efficient acquisition of public keys.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Public key Infrastructure (PKI)



Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject

Public key Infrastructure (PKI) – Cont…
End entity: A generic term used to denote end users, devices (e.g., servers, routers), or any other entity that can be identified in the subject field of a public-key certificate.
Certification authority (CA): The issuer of certificates and (usually) certificate revocation lists (CRLs).
Registration authority (RA): An optional component that can assume a number of administrative functions from the CA.
CRL issuer: An optional component that a CA can delegate to publish CRLs.
Repository: A generic term used to denote any method for storing certificates and CRLs so that they can be retrieved by end entities.

Unit-8  Key management and distribution                            Darshan Institute of Engineering & Technology   ‹#›
INS is very Interesting Subject




