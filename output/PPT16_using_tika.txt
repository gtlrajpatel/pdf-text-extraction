











































OOPC++ UNIT-1


Prof. Rupesh G. Vaishnav
rupesh.vaishnav@darshan.ac.in
94280-37452
Information & Network Security (2170709)	 Darshan Institute of Engineering & Technology
UNIT-4
Asymmetric Ciphers





1

Outline
Public Key Cryptosystems with Applications
Requirements and Cryptanalysis
RSA algorithm
RSA computational aspects and security
Diffie-Hillman Key Exchange algorithm
Man-in-Middle attack 

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

X.800 and RFC 2828
International Telecommunication Union (ITU)
2

Symmetric key Encryption





Plaintext
input
Plaintext
output
Encryption Algorithm
(e.g. AES)
Decryption Algorithm
(reverse of encryption algorithm)
Secret key shared by sender and recipient
X

Secret key shared by sender and recipient
K
Transmitted
cipher text

Y = E(K, X)
K
X

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›





Plaintext
input
Plaintext
output
Encryption Algorithm
(e.g. RSA)
Decryption Algorithm
X

Transmitted
cipher text

Y = E(PUa, X)
X
Bob’s Public key ring
Alice


Ted

Mike

Joy
Alice’s public key
PUa
Alice’s private key
PRa
Asymmetric key Encryption with Public Key
Bob
Alice
The entire encrypted message serves as a confidentiality. 





4





Plaintext
input
Plaintext
output
Encryption Algorithm
(e.g. RSA)
Decryption Algorithm
X

Transmitted
cipher text

Y = E(PRb, X)
X
Alice’s Public key ring
Bob


Ted

Mike

Joy
Bob’s public key
PUb
Bob’s private key
PRb
Asymmetric key Encryption with Private Key
Bob
Alice

The entire encrypted message serves as a digital signature. 



Authentication and Confidentiality
Message
source
Encryption
Algorithm
Encryption
Algorithm
Decryption
Algorithm
Decryption
Algorithm
Message
Dest.
X
Y
Y
X
Z
Key pair
source
Key pair
source


PRa
PUa
PRb
PUb

Source A

Source B
Z = E(PUb, E(PRa, X))
X = D(PUa, D(PRB, Z))

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›


6

Applications for Public-Key Cryptosystems
Encryption/decryption: The sender encrypts a message with the recipient’s public key.
Digital signature: The sender “signs” a message with its private key. Signing is achieved by a cryptographic algorithm applied to the message or to a small block of data that is a function of the message.
Key exchange: Two sides cooperate to exchange a session key. Several different approaches are possible, involving the private key(s) of one or both parties.

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

RSA Algorithm
RSA is a block cipher in which the Plaintext and Ciphertext are represented as integers between 0 and n-1 for some n.
Large messages can be broken up into a number of blocks. 
Each block would then be represented by an integer.

Step-1: Generate Public key and Private key
Step-2: Encrypt message using Public key
Step-3: Decrypt message using Private key 



Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Step-1: Generate Public key and Private key
Select two large prime numbers:  p and q
Calculate modulus : n = p * q
Calculate Euler’s totient function : φ(n) = (p-1) * (q-1)
Select e such that e is relatively prime to φ(n) and 1 < e < φ(n)



Determine d such that d * e ≡ 1 (mod φ(n))
Publickey : PU = { e, n }
Privatekey : PR = { d, n }

Two numbers are relatively prime if they have no common factors other than 1.

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Step-1: Generate Public key and Private key
Select two large prime numbers:  p = 3 and q = 11
Calculate modulus : n = p * q, n = 33
Calculate Euler’s totient function : φ(n) = (p-1) * (q-1)
	φ(n) = ( 3 – 1 )  * ( 11 – 1 ) = 20
Select e such that e is relatively prime to φ(n) and 1 < e < φ(n)
We have several choices for e : 7, 11, 13, 17, 19 Let’s take e = 7
Determine d such that d * e ≡ 1 (mod φ(n))
? * 7 ≡ 1 (mod 20), 3 * 7 ≡ 1 (mod 20)

Public key : PU = { e, n } , PU = { 7, 33 }
Private key : PR = { d, n }, PR = { 3, 33 }


This is equivalent to finding d which satisfies de = 1 + j.φ(n) where j is any integer.
We can rewrite this as 
   d = (1 + j. φ(n)) / e

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Step-2 : Encrypt Message

Encryption Using Public key:
C = Me mod n
Ciphertext
Input Message
Publickey
For message M = 14
C = 147 mod 33
C = [(141 mod 33) X (142 mod 33) X (144 mod 33)] mod 33
C = (14 X 31 X 4) mod 33 = 1736 mod 33
C = 20
PU = { e, n } , PU = { 7, 33 }

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Step-3 : Decrypt Message

Encryption Using Public key:
M = Cd mod n
Plaintext
Message
Cipher
Message
Privatekey
For Ciphertext C = 20
M = 203 mod 33
M = [(201 mod 33) X (202 mod 33)] mod 33
M = (20 X 4) mod 33 = 80 mod 33
M = 14
PR = { d, n } , PR = { 3, 33 }

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Example RSA Algorithm
147 mod 33 = 20 
Plaintext
14
Plaintext
14
203 mod 33 = 14 
Ciphertext
20
PU = 7, 33
PR = 3, 33
Encryption
Decryption





Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

RSA Example
Find n, φ(n), e, d for p=7 and q= 19 then demonstrate encryption and decryption for M = 6
n = p * q = 7 * 19 = 133
φ(n) = ( p – 1 ) * ( q – 1) = 108
Finding e relatively prime to 108
e = 2 => GCD( 2, 108 ) = 2 (no)
e = 3 => GCD( 3, 108 ) = 3 (no)
e = 5 => GCD( 5, 108 ) = 1 (Yes)
Finding d such that (d * e ) mod φ(n) = 1 
We can rewrite this as d = (1 + j . φ(n)) / e
j = 0  => d = 1 / 5 = 0.2  integer ? (no)
j = 1  => d = 109 / 5 = 21.8  integer ? (no)
j = 2  => d = 217 / 5 = 43.4  integer ? (no)
j = 3  => d = 325 / 5 = 65 integer ? (yes)
Public key : 
PU = { e, n } = {5, 133}
Private key : 
PR = { d, n } = {65, 133}

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

RSA Example – cont…
Encryption:
C = Me mod n
For message M = 6
C = 65 mod 133
C = 7776 mod 33
C = 62
PU = { e, n } , PU = { 5, 133 }
Decryption:
M = Cd mod n
For C = 62
M = 6265 mod 133
M = 2666 mod 33
M = 6
PR = { d, n } , PU = { 65, 133 }

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

RSA Example
P and Q are two prime numbers. P=7, and Q=17.  Take public key E=5. If plain text value is 10, then what will be cipher text value according to RSA algorithm? 
n = 119
φ(n) = 96
e = 5
d = 77
PU = { 5, 119 }
PR = {77, 119}
C = 105 mod 119 => C = 40


Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman key Exchange
The purpose of the Diffie-Hellman algorithm is to enable two users to securely exchange a key that can be used for subsequent encryption of message.
This algorithm depends for its effectiveness on the difficulty of computing discrete logarithms.




Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Primitive root
Let  be a prime number
Then  is a primitive root for , if the powers of  modulo  generates all integers from 1 to  – 1 in some permutation.

Example: p = 7 then primitive root is 3 because powers of 3 mod 7 generates all the integers from 1 to 6









Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Discrete Logarithm
For any integer  and a primitive root  of prime number , we can find a unique exponent  such that

The exponent  is referred as the discrete logarithm of  for the base , mod . It expressed as below.







Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman Key Exchange – Cont…
User A and User B agree on two large prime numbers q and α. User A and User B can use insecure channel to agree on them.
User A selects a random integer  and calculates 

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman Key Exchange – Cont…
Global Public Elements
                                                            prime number
                                                            <  and  is primitive root of 
User A Key Generation
            Select private                      
            Calculate public                  
User B Key Generation
            Select private                      
            Calculate public                  

Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman Key Exchange – Cont…
User A Key Generation
            Select private                      
            Calculate public                 
User B Key Generation
            Select private                      
            Calculate public                 
Calculation of Secret Key by User A
            
Calculation of Secret Key by User b
            



Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman Key Exchange – Cont…
User A Key Generation
Private            ,                    Public            
User B Key Generation
Private           ,                    Public            
Secret Key by User A : 
Secret Key by User B : 

 
  
 
 
 
  
 




Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›




Diffie-Hellman Key Exchange Example
Alice and bob agrees on a prime number 
 as primitive root of 
Alice selects a private integer  
Alice computes  => 
Bob selects a private integer  
Bob computes  => 
Alice sends  to Bob and Bob sends  to Alice
Alice computes key  => 

Bob computes key => 



Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Diffie-Hellman Key Exchange Illustration



Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›

Man in the middle attack
Suppose Alice and Bob wish to exchange keys, and Darth is the adversary.
Darth prepares for the attack by generating two random private keys XD1 and XD2 and then computes corresponding public keys YD1 and YD2.
Alice transmits YA to Bob.
Darth intercepts YA and transmits YD1 to Bob. Darth also calculates K2=(YA)XD2 mod q.
Bob receives YD1 and calculates K1 =  (YD1)XB mod q.
Bob transmits YB to Alice.
Darth intercepts YB and transmits YD2 to Alice. Darth calculates K1=(YB)XD1 mod q.
Alice receives YD2 and calculates K2 = (YD2)XA mod q.


Unit-4 Asymmertic Ciphers                                                       Darshan Institute of Engineering & Technology   ‹#›







